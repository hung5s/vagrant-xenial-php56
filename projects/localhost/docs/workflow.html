<h1>Development workflow</h1>

<h2>Cronjob to checkout code</h2>

<p>Create a cronjob to update code regularly with this checkout command:</p>

<pre>*/30 * * * * php /host/projects/deploy/run.php Project --path=/host/projects/your-project</pre>

<h2>Committing code</h2>

<p>Each module (or theme, config folder) in Indition has its own SVN, when commit code note that:</p>

<ul>
    <li>If you are using a SVN client tool, DO NOT commit files in 2 or more modules at once</li>
    <li>Run <code>svn diff --summarize . -r head</code> inside a module folder to see list of changed files</li>
    <li>Run <code>svn diff . -r head > [module-name].diff</code> to have all the changes of all files written into a .diff file. Most of SVN/Git tool will be able to read .diff file and show visual diffs</li>
</ul>

<h2>DB patches and Reloading DB</h2>

<p class="alert alert-warniing">Before reloading your local DB with a DB dump file, i.e. from LIVE site, make sure you backup your data</p>

<p>Use/write Indtion patch file to altery DB schema such as create new table or change column data type, add/remove column. Also use patch to insert/delete data if needed.</p>

<p>Some commands to work with PostgreSQL</p>

<ul>
    <li>Connect to DB from console: <code>psql -U postgres</code> Type \q to exit</li>
    <li>Empty the database: <code>psql -U postgres -d db-name -c "drop schema public cascade;"</code></li>
    <li>Load a dump file into database: <code>psql -U postgres -d db-name -f path-to-file</code></li>
    <li>Dump a database into file: <code>pg_dump -U postgres -h db-host db-name --exclude-table-data '*_log' -T 'prefix_*' | gzip -c > file-name.gz</code></li>
    <li>Dump only selected tables: <code>pg_dump -U postgres -h db-host db-name -t table-name -f filename.sql</code></li>
</ul>

<h2>Testing APIs</h2>

<p>Indition has a strong API documentor and test tool. Make sure you checkout <code>Test</code> mdoule and go to <strong>/test</strong> to start using this tool.</p>

<ul>
    <li>New API is detected automationcally</li>
    <li>You can view your API source code directly inside the tool</li>
    <li>Use 'Edit Tests' to edit or generate new tests for your API</li>
    <li>Write your API and run your test simultanously help you test your API code faster</li>
</ul>

<h3>Why test?</h3>
<p>Writing tests for your new API or generating even only basic test for existing APIs gives a lot of benefit.</p>

<ul>
    <li>Test tools helps you run <strong>many tests</strong> against your API with one click.</li>
    <li>If you change an API, run all tests is the fastest way to make sure your change passes all tests</li>
    <li>Testing APIs within /test environment keeps your DB safe</li>
    <li>Test result (shown in Chrome debug window) provide information about <strong>time spent per API</strong>, <strong>hooks</strong> and results of each hooks</li>
</ul>